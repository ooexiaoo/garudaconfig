"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([["node_modules_pmcrypto-v6-canary_node_modules_openpgp_dist_lightweight_noble_curves_min_mjs"],{46504:(t,e,r)=>{r.d(e,{nobleCurves:()=>tj});var i=r(33558);/*! OpenPGP.js v6.0.0-beta.2 - 2024-07-05 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class n extends i.H{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,i.h)(t);let r=(0,i.t)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,f=new Uint8Array(n);f.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<f.length;t++)f[t]^=54;this.iHash.update(f),this.oHash=t.create();for(let t=0;t<f.length;t++)f[t]^=106;this.oHash.update(f),f.fill(0)}update(t){return(0,i.e)(this),this.iHash.update(t),this}digestInto(t){(0,i.e)(this),(0,i.b)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:i,destroyed:n,blockLen:f,outputLen:o}=this;return t.finished=i,t.destroyed=n,t.blockLen=f,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let f=(t,e,r)=>new n(t,e).update(r).digest();f.create=(t,e)=>new n(t,e)/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;let o=BigInt(0),s=BigInt(1),a=BigInt(2);function l(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function d(t){if(!l(t))throw Error("Uint8Array expected")}let h=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function c(t){d(t);let e="";for(let r=0;r<t.length;r++)e+=h[t[r]];return e}function u(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function b(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x"+t)}let g={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function p(t){return t>=g._0&&t<=g._9?t-g._0:t>=g._A&&t<=g._F?t-(g._A-10):t>=g._a&&t<=g._f?t-(g._a-10):void 0}function y(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let i=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=p(t.charCodeAt(n)),f=p(t.charCodeAt(n+1));if(void 0===r||void 0===f)throw Error('hex string expected, got non-hex character "'+(t[n]+t[n+1])+'" at index '+n);i[e]=16*r+f}return i}function B(t){return b(c(t))}function w(t){return d(t),b(c(Uint8Array.from(t).reverse()))}function x(t,e){return y(t.toString(16).padStart(2*e,"0"))}function m(t,e){return x(t,e).reverse()}function E(t,e,r){let i;if("string"==typeof e)try{i=y(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!l(e))throw Error(t+" must be hex string or Uint8Array");i=Uint8Array.from(e)}let n=i.length;if("number"==typeof r&&n!==r)throw Error(`${t} expected ${r} bytes, got ${n}`);return i}function I(...t){let e=0;for(let r=0;r<t.length;r++){let i=t[r];d(i),e+=i.length}let r=new Uint8Array(e);for(let e=0,i=0;e<t.length;e++){let n=t[e];r.set(n,i),i+=n.length}return r}let S=t=>(a<<BigInt(t-1))-s,v=t=>new Uint8Array(t),A=t=>Uint8Array.from(t);function L(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=v(t),n=v(t),f=0,o=()=>{i.fill(1),n.fill(0),f=0},s=(...t)=>r(n,i,...t),a=(t=v())=>{n=s(A([0]),t),i=s(),0!==t.length&&(n=s(A([1]),t),i=s())},l=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(i=s()).slice();r.push(e),t+=i.length}return I(...r)};return(t,e)=>{let r;for(o(),a(t);!(r=e(l()));)a();return o(),r}}let O={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||l(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function H(t,e,r={}){let i=(e,r,i)=>{let n=O[r];if("function"!=typeof n)throw Error(`Invalid validator "${r}", expected function`);let f=t[e];if(!(i&&void 0===f||n(f,t)))throw Error(`Invalid param ${e+""}=${f} (${typeof f}), expected ${r}`)};for(let[t,r]of Object.entries(e))i(t,r,!1);for(let[t,e]of Object.entries(r))i(t,e,!0);return t}var R=Object.freeze({__proto__:null,abytes:d,bitGet:function(t,e){return t>>BigInt(e)&s},bitLen:function(t){let e;for(e=0;t>o;t>>=s,e+=1);return e},bitMask:S,bitSet:function(t,e,r){return t|(r?s:o)<<BigInt(e)},bytesToHex:c,bytesToNumberBE:B,bytesToNumberLE:w,concatBytes:I,createHmacDrbg:L,ensureBytes:E,equalBytes:function(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r},hexToBytes:y,hexToNumber:b,isBytes:l,numberToBytesBE:x,numberToBytesLE:m,numberToHexUnpadded:u,numberToVarBytesBE:function(t){return y(u(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:H});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let U=BigInt(0),k=BigInt(1),F=BigInt(2),q=BigInt(3),_=BigInt(4),C=BigInt(5),N=BigInt(8);function P(t,e){let r=t%e;return r>=U?r:e+r}function G(t,e,r){if(r<=U||e<U)throw Error("Expected power/modulo > 0");if(r===k)return U;let i=k;for(;e>U;)e&k&&(i=i*t%r),t=t*t%r,e>>=k;return i}function z(t,e,r){let i=t;for(;e-- >U;)i*=i,i%=r;return i}function T(t,e){if(t===U||e<=U)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=P(t,e),i=e,n=U,f=k;for(;r!==U;){let t=i%r,e=n-i/r*f;i=r,r=t,n=f,f=e}if(i!==k)throw Error("invert: does not exist");return P(n,e)}BigInt(9),BigInt(16);let D=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Z(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function $(t,e,r=!1,i={}){if(t<=U)throw Error("Expected Field ORDER > 0, got "+t);let{nBitLength:n,nByteLength:f}=Z(t,e);if(f>2048)throw Error("Field lengths over 2048 bytes are not supported");let o=function(t){if(t%_===q){let e=(t+k)/_;return function(t,r){let i=t.pow(r,e);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}}if(t%N===C){let e=(t-C)/N;return function(t,r){let i=t.mul(r,F),n=t.pow(i,e),f=t.mul(r,n),o=t.mul(t.mul(f,F),n),s=t.mul(f,t.sub(o,t.ONE));if(!t.eql(t.sqr(s),r))throw Error("Cannot find square root");return s}}return function(t){let e,r,i;let n=(t-k)/F;for(e=t-k,r=0;e%F===U;e/=F,r++);for(i=F;i<t&&G(i,n,t)!==t-k;i++);if(1===r){let e=(t+k)/_;return function(t,r){let i=t.pow(r,e);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}}let f=(e+k)/F;return function(t,o){if(t.pow(o,n)===t.neg(t.ONE))throw Error("Cannot find square root");let s=r,a=t.pow(t.mul(t.ONE,i),e),l=t.pow(o,f),d=t.pow(o,e);for(;!t.eql(d,t.ONE);){if(t.eql(d,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(d);e<s&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(a,k<<BigInt(s-e-1));a=t.sqr(r),l=t.mul(l,r),d=t.mul(d,a),s=e}return l}}(t)}(t),s=Object.freeze({ORDER:t,BITS:n,BYTES:f,MASK:S(n),ZERO:U,ONE:k,create:e=>P(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("Invalid field element: expected bigint, got "+typeof e);return U<=e&&e<t},is0:t=>t===U,isOdd:t=>(t&k)===k,neg:e=>P(-e,t),eql:(t,e)=>t===e,sqr:e=>P(e*e,t),add:(e,r)=>P(e+r,t),sub:(e,r)=>P(e-r,t),mul:(e,r)=>P(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<U)throw Error("Expected power > 0");if(r===U)return t.ONE;if(r===k)return e;let i=t.ONE,n=e;for(;r>U;)r&k&&(i=t.mul(i,n)),n=t.sqr(n),r>>=k;return i})(s,t,e),div:(e,r)=>P(e*T(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>T(e,t),sqrt:i.sqrt||(t=>o(s,t)),invertBatch:t=>(function(t,e){let r=Array(e.length),i=e.reduce((e,i,n)=>t.is0(i)?e:(r[n]=e,t.mul(e,i)),t.ONE),n=t.inv(i);return e.reduceRight((e,i,n)=>t.is0(i)?e:(r[n]=t.mul(e,r[n]),t.mul(e,i)),n),r})(s,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?m(t,f):x(t,f),fromBytes:t=>{if(t.length!==f)throw Error(`Fp.fromBytes: expected ${f}, got ${t.length}`);return r?w(t):B(t)}});return Object.freeze(s)}function j(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function V(t){let e=j(t);return e+Math.ceil(e/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let K=BigInt(0),M=BigInt(1);function Y(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},i=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let i=t.ZERO,n=e;for(;r>K;)r&M&&(i=i.add(n)),n=n.double(),r>>=M;return i},precomputeWindow(t,e){let{windows:r,windowSize:n}=i(e),f=[],o=t,s=o;for(let t=0;t<r;t++){s=o,f.push(s);for(let t=1;t<n;t++)s=s.add(o),f.push(s);o=s.double()}return f},wNAF(e,n,f){let{windows:o,windowSize:s}=i(e),a=t.ZERO,l=t.BASE,d=BigInt(2**e-1),h=2**e,c=BigInt(e);for(let t=0;t<o;t++){let e=t*s,i=Number(f&d);f>>=c,i>s&&(i-=h,f+=M);let o=e+Math.abs(i)-1,u=t%2!=0,b=i<0;0===i?l=l.add(r(u,n[e])):a=a.add(r(b,n[o]))}return{p:a,f:l}},wNAFCached(t,e,r,i){let n=t._WINDOW_SIZE||1,f=e.get(t);return f||(f=this.precomputeWindow(t,n),1!==n&&e.set(t,i(f))),this.wNAF(n,f,r)}}}function W(t){return H(t.Fp,D.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),H(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Z(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let{bytesToNumberBE:X,hexToBytes:J}=R,Q={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){let{Err:e}=Q;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");let r=t[1],i=t.subarray(2,r+2);if(!r||i.length!==r)throw new e("Invalid signature integer: wrong length");if(128&i[0])throw new e("Invalid signature integer: negative");if(0===i[0]&&!(128&i[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:X(i),l:t.subarray(r+2)}},toSig(t){let{Err:e}=Q,r="string"==typeof t?J(t):t;d(r);let i=r.length;if(i<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==i-2)throw new e("Invalid signature: incorrect length");let{d:n,l:f}=Q._parseInt(r.subarray(2)),{d:o,l:s}=Q._parseInt(f);if(s.length)throw new e("Invalid signature: left bytes after parsing");return{r:n,s:o}},hexFromSig(t){let e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{let e=t.toString(16);return 1&e.length?"0"+e:e},i=e(r(t.s)),n=e(r(t.r)),f=i.length/2,o=n.length/2,s=r(f),a=r(o);return`30${r(o+f+4)}02${a}${n}02${s}${i}`}},tt=BigInt(0),te=BigInt(1);BigInt(2);let tr=BigInt(3);function ti(t,e){let r=e=>(function(t){let e=function(t){let e=W(t);return H(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:i}=e,n=r.BYTES+1,f=2*r.BYTES+1;function o(t){return P(t,i)}let{ProjectivePoint:s,normPrivateKeyToScalar:a,weierstrassEquation:d,isWithinCurveOrder:h}=function(t){let e=function(t){let e=W(t);H(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:n}=e;if(r){if(!i.eql(n,i.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,i=e.toBytes||((t,e,i)=>{let n=e.toAffine();return I(Uint8Array.from([4]),r.toBytes(n.x),r.toBytes(n.y))}),n=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function f(t){let{a:i,b:n}=e,f=r.sqr(t),o=r.mul(f,t);return r.add(r.add(o,r.mul(t,i)),n)}if(!r.eql(r.sqr(e.Gy),f(e.Gx)))throw Error("bad generator point: equation left != right");function o(t){return"bigint"==typeof t&&tt<t&&t<e.n}function s(t){if(!o(t))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function a(t){let r;let{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:f,n:o}=e;if(i&&"bigint"!=typeof t){if(l(t)&&(t=c(t)),"string"!=typeof t||!i.includes(t.length))throw Error("Invalid key");t=t.padStart(2*n,"0")}try{r="bigint"==typeof t?t:B(E("private key",t,n))}catch(e){throw Error(`private key must be ${n} bytes, hex or bigint, not ${typeof t}`)}return f&&(r=P(r,o)),s(r),r}let d=new Map;function h(t){if(!(t instanceof u))throw Error("ProjectivePoint expected")}class u{constructor(t,e,i){if(this.px=t,this.py=e,this.pz=i,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==i||!r.isValid(i))throw Error("z required")}static fromAffine(t){let{x:e,y:i}=t||{};if(!t||!r.isValid(e)||!r.isValid(i))throw Error("invalid affine point");if(t instanceof u)throw Error("projective point not allowed");let n=t=>r.eql(t,r.ZERO);return n(e)&&n(i)?u.ZERO:new u(e,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(u.fromAffine)}static fromHex(t){let e=u.fromAffine(n(E("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return u.BASE.multiply(a(t))}_setWindowSize(t){this._WINDOW_SIZE=t,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw Error("bad point: ZERO")}let{x:t,y:i}=this.toAffine();if(!r.isValid(t)||!r.isValid(i))throw Error("bad point: x or y not FE");let n=r.sqr(i),o=f(t);if(!r.eql(n,o))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){h(t);let{px:e,py:i,pz:n}=this,{px:f,py:o,pz:s}=t,a=r.eql(r.mul(e,s),r.mul(f,n)),l=r.eql(r.mul(i,s),r.mul(o,n));return a&&l}negate(){return new u(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:i}=e,n=r.mul(i,tr),{px:f,py:o,pz:s}=this,a=r.ZERO,l=r.ZERO,d=r.ZERO,h=r.mul(f,f),c=r.mul(o,o),b=r.mul(s,s),g=r.mul(f,o);return g=r.add(g,g),d=r.mul(f,s),d=r.add(d,d),a=r.mul(t,d),l=r.mul(n,b),l=r.add(a,l),a=r.sub(c,l),l=r.add(c,l),l=r.mul(a,l),a=r.mul(g,a),d=r.mul(n,d),b=r.mul(t,b),g=r.sub(h,b),g=r.mul(t,g),g=r.add(g,d),d=r.add(h,h),h=r.add(d,h),h=r.add(h,b),h=r.mul(h,g),l=r.add(l,h),b=r.mul(o,s),b=r.add(b,b),h=r.mul(b,g),a=r.sub(a,h),d=r.mul(b,c),d=r.add(d,d),new u(a,l,d=r.add(d,d))}add(t){h(t);let{px:i,py:n,pz:f}=this,{px:o,py:s,pz:a}=t,l=r.ZERO,d=r.ZERO,c=r.ZERO,b=e.a,g=r.mul(e.b,tr),p=r.mul(i,o),y=r.mul(n,s),B=r.mul(f,a),w=r.add(i,n),x=r.add(o,s);w=r.mul(w,x),x=r.add(p,y),w=r.sub(w,x),x=r.add(i,f);let m=r.add(o,a);return x=r.mul(x,m),m=r.add(p,B),x=r.sub(x,m),m=r.add(n,f),l=r.add(s,a),m=r.mul(m,l),l=r.add(y,B),m=r.sub(m,l),c=r.mul(b,x),l=r.mul(g,B),c=r.add(l,c),l=r.sub(y,c),c=r.add(y,c),d=r.mul(l,c),y=r.add(p,p),y=r.add(y,p),B=r.mul(b,B),x=r.mul(g,x),y=r.add(y,B),B=r.sub(p,B),B=r.mul(b,B),x=r.add(x,B),p=r.mul(y,x),d=r.add(d,p),p=r.mul(m,x),l=r.mul(w,l),l=r.sub(l,p),p=r.mul(w,y),c=r.mul(m,c),new u(l,d,c=r.add(c,p))}subtract(t){return this.add(t.negate())}is0(){return this.equals(u.ZERO)}wNAF(t){return g.wNAFCached(this,d,t,t=>{let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(u.fromAffine)})}multiplyUnsafe(t){let i=u.ZERO;if(t===tt)return i;if(s(t),t===te)return this;let{endo:n}=e;if(!n)return g.unsafeLadder(this,t);let{k1neg:f,k1:o,k2neg:a,k2:l}=n.splitScalar(t),d=i,h=i,c=this;for(;o>tt||l>tt;)o&te&&(d=d.add(c)),l&te&&(h=h.add(c)),c=c.double(),o>>=te,l>>=te;return f&&(d=d.negate()),a&&(h=h.negate()),h=new u(r.mul(h.px,n.beta),h.py,h.pz),d.add(h)}multiply(t){let i,n;s(t);let{endo:f}=e;if(f){let{k1neg:e,k1:o,k2neg:s,k2:a}=f.splitScalar(t),{p:l,f:d}=this.wNAF(o),{p:h,f:c}=this.wNAF(a);l=g.constTimeNegate(e,l),h=g.constTimeNegate(s,h),h=new u(r.mul(h.px,f.beta),h.py,h.pz),i=l.add(h),n=d.add(c)}else{let{p:e,f:r}=this.wNAF(t);i=e,n=r}return u.normalizeZ([i,n])[0]}multiplyAndAddUnsafe(t,e,r){let i=u.BASE,n=(t,e)=>e!==tt&&e!==te&&t.equals(i)?t.multiply(e):t.multiplyUnsafe(e),f=n(this,e).add(n(t,r));return f.is0()?void 0:f}toAffine(t){let{px:e,py:i,pz:n}=this,f=this.is0();null==t&&(t=f?r.ONE:r.inv(n));let o=r.mul(e,t),s=r.mul(i,t),a=r.mul(n,t);if(f)return{x:r.ZERO,y:r.ZERO};if(!r.eql(a,r.ONE))throw Error("invZ was invalid");return{x:o,y:s}}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===te)return!0;if(r)return r(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===te?this:r?r(u,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),i(u,this,t)}toHex(t=!0){return c(this.toRawBytes(t))}}u.BASE=new u(e.Gx,e.Gy,r.ONE),u.ZERO=new u(r.ZERO,r.ONE,r.ZERO);let b=e.nBitLength,g=Y(u,e.endo?Math.ceil(b/2):b);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:a,weierstrassEquation:f,isWithinCurveOrder:o}}({...e,toBytes(t,e,i){let n=e.toAffine(),f=r.toBytes(n.x);return i?I(Uint8Array.from([e.hasEvenY()?2:3]),f):I(Uint8Array.from([4]),f,r.toBytes(n.y))},fromBytes(t){let e=t.length,i=t[0],o=t.subarray(1);if(e!==n||2!==i&&3!==i){if(e===f&&4===i)return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${n} compressed bytes or ${f} uncompressed bytes`)}{let t;let e=B(o);if(!(tt<e&&e<r.ORDER))throw Error("Point is not on curve");let n=d(e);try{t=r.sqrt(n)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return!(1&~i)!=((t&te)===te)&&(t=r.neg(t)),{x:e,y:t}}}}),u=t=>c(x(t,e.nByteLength)),b=(t,e,r)=>B(t.slice(e,r));class g{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let r=e.nByteLength;return new g(b(t=E("compactSignature",t,2*r),0,r),b(t,r,2*r))}static fromDER(t){let{r:e,s:r}=Q.toSig(E("DER",t));return new g(e,r)}assertValidity(){if(!h(this.r))throw Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new g(this.r,this.s,t)}recoverPublicKey(t){let{r:n,s:f,recovery:a}=this,l=A(E("msgHash",t));if(null==a||![0,1,2,3].includes(a))throw Error("recovery id invalid");let d=2===a||3===a?n+e.n:n;if(d>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let h=1&a?"03":"02",c=s.fromHex(h+u(d)),b=T(d,i),g=o(-l*b),p=o(f*b),y=s.BASE.multiplyAndAddUnsafe(c,g,p);if(!y)throw Error("point at infinify");return y.assertValidity(),y}hasHighS(){return this.s>i>>te}normalizeS(){return this.hasHighS()?new g(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return y(this.toDERHex())}toDERHex(){return Q.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return y(this.toCompactHex())}toCompactHex(){return u(this.r)+u(this.s)}}function p(t){let e=l(t),r="string"==typeof t,i=(e||r)&&t.length;return e?i===n||i===f:r?i===2*n||i===2*f:t instanceof s}let v=e.bits2int||function(t){let r=B(t),i=8*t.length-e.nBitLength;return i>0?r>>BigInt(i):r},A=e.bits2int_modN||function(t){return o(v(t))},O=S(e.nBitLength);function R(t){if("bigint"!=typeof t)throw Error("bigint expected");if(!(tt<=t&&t<O))throw Error("bigint expected < 2^"+e.nBitLength);return x(t,e.nByteLength)}let U={lowS:e.lowS,prehash:!1},F={lowS:e.lowS,prehash:!1};return s.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return s.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(p(t))throw Error("first arg must be private key");if(!p(e))throw Error("second arg must be public key");return s.fromHex(e).multiply(a(t)).toRawBytes(r)},sign:function(t,n,f=U){let{seed:l,k2sig:d}=function(t,n,f=U){if(["recovered","canonical"].some(t=>t in f))throw Error("sign() legacy options not supported");let{hash:l,randomBytes:d}=e,{lowS:c,prehash:u,extraEntropy:b}=f;null==c&&(c=!0),t=E("msgHash",t),u&&(t=E("prehashed msgHash",l(t)));let p=A(t),y=a(n),B=[R(y),R(p)];if(null!=b&&!1!==b){let t=!0===b?d(r.BYTES):b;B.push(E("extraEntropy",t))}return{seed:I(...B),k2sig:function(t){let e=v(t);if(!h(e))return;let r=T(e,i),n=s.BASE.multiply(e).toAffine(),f=o(n.x);if(f===tt)return;let a=o(r*o(p+f*y));if(a===tt)return;let l=(n.x===f?0:2)|Number(n.y&te),d=a;return c&&a>i>>te&&(d=a>i>>te?o(-a):a,l^=1),new g(f,d,l)}}}(t,n,f);return L(e.hash.outputLen,e.nByteLength,e.hmac)(l,d)},verify:function(t,r,n,f=F){let a,d;if(r=E("msgHash",r),n=E("publicKey",n),"strict"in f)throw Error("options.strict was renamed to lowS");let{lowS:h,prehash:c}=f;try{if("string"==typeof t||l(t))try{a=g.fromDER(t)}catch(e){if(!(e instanceof Q.Err))throw e;a=g.fromCompact(t)}else{if("object"!=typeof t||"bigint"!=typeof t.r||"bigint"!=typeof t.s)throw Error("PARSE");{let{r:e,s:r}=t;a=new g(e,r)}}d=s.fromHex(n)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(h&&a.hasHighS())return!1;c&&(r=e.hash(r));let{r:u,s:b}=a,p=A(r),y=T(b,i),B=o(p*y),w=o(u*y),x=s.BASE.multiplyAndAddUnsafe(d,B,w)?.toAffine();return!!x&&o(x.x)===u},ProjectivePoint:s,Signature:g,utils:{isValidPrivateKey(t){try{return a(t),!0}catch(t){return!1}},normPrivateKeyToScalar:a,randomPrivateKey:()=>{let t=V(e.n);return function(t,e,r=!1){let i=t.length,n=j(e),f=V(e);if(i<16||i<f||i>1024)throw Error(`expected ${f}-1024 bytes of input, got ${i}`);let o=P(r?B(t):w(t),e-k)+k;return r?m(o,n):x(o,n)}(e.randomBytes(t),e.n)},precompute:(t=8,e=s.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...t,hash:e,hmac:(t,...r)=>f(e,t,(0,i.c)(...r)),randomBytes:i.r});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);let tn=$(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tf=ti({a:tn.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:tn,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},i.s),to=$(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),ts=ti({a:to.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:to,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},i.a),ta=$(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tl={a:ta.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:ta,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},td=ti({a:tl.a,b:tl.b,Fp:ta,n:tl.n,Gx:tl.Gx,Gy:tl.Gy,h:tl.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},i.d),th=BigInt(0),tc=BigInt(1),tu=BigInt(2),tb=BigInt(8),tg={zip215:!0},tp=BigInt(0),ty=BigInt(1),tB=(0,i.w)(()=>i.f.create({dkLen:114})),tw=((0,i.w)(()=>i.f.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),tx=BigInt(1),tm=BigInt(2),tE=BigInt(3);BigInt(4);let tI=BigInt(11),tS=BigInt(22),tv=BigInt(44),tA=BigInt(88),tL=BigInt(223);function tO(t){let e=t*t*t%tw,r=e*e*t%tw,i=z(r,tE,tw)*r%tw,n=z(i,tE,tw)*r%tw,f=z(n,tm,tw)*e%tw,o=z(f,tI,tw)*f%tw,s=z(o,tS,tw)*o%tw,a=z(s,tv,tw)*s%tw,l=z(a,tA,tw)*a%tw,d=z(l,tv,tw)*s%tw,h=z(d,tm,tw)*e%tw,c=z(h,tx,tw)*t%tw;return z(c,tL,tw)*h%tw}function tH(t){return t[0]&=252,t[55]|=128,t[56]=0,t}let tR=$(tw,456,!0),tU=function(t){let e=function(t){let e=W(t);return H(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:i,prehash:n,hash:f,randomBytes:o,nByteLength:s,h:a}=e,l=tu<<BigInt(8*s)-tc,d=r.create,h=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:th}}}),u=e.adjustScalarBytes||(t=>t),b=e.domain||((t,e,r)=>{if(e.length||r)throw Error("Contexts/pre-hash are not supported");return t}),g=t=>"bigint"==typeof t&&th<t,p=(t,e)=>g(t)&&g(e)&&t<e,y=t=>t===th||p(t,l);function B(t,e){if(p(t,e))return t;throw Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function x(t){return t===th?t:B(t,i)}let S=new Map;function v(t){if(!(t instanceof A))throw Error("ExtendedPoint expected")}class A{constructor(t,e,r,i){if(this.ex=t,this.ey=e,this.ez=r,this.et=i,!y(t))throw Error("x required");if(!y(e))throw Error("y required");if(!y(r))throw Error("z required");if(!y(i))throw Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof A)throw Error("extended point not allowed");let{x:e,y:r}=t||{};if(!y(e)||!y(r))throw Error("invalid affine point");return new A(e,r,tc,d(e*r))}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(A.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,S.delete(this)}assertValidity(){let{a:t,d:r}=e;if(this.is0())throw Error("bad point: ZERO");let{ex:i,ey:n,ez:f,et:o}=this,s=d(i*i),a=d(n*n),l=d(f*f),h=d(l*l),c=d(s*t);if(d(l*d(c+a))!==d(h+d(r*d(s*a))))throw Error("bad point: equation left != right (1)");if(d(i*n)!==d(f*o))throw Error("bad point: equation left != right (2)")}equals(t){v(t);let{ex:e,ey:r,ez:i}=this,{ex:n,ey:f,ez:o}=t,s=d(e*o),a=d(n*i),l=d(r*o),h=d(f*i);return s===a&&l===h}is0(){return this.equals(A.ZERO)}negate(){return new A(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:t}=e,{ex:r,ey:i,ez:n}=this,f=d(r*r),o=d(i*i),s=d(tu*d(n*n)),a=d(t*f),l=r+i,h=d(d(l*l)-f-o),c=a+o,u=c-s,b=a-o,g=d(h*u),p=d(c*b),y=d(h*b);return new A(g,p,d(u*c),y)}add(t){v(t);let{a:r,d:i}=e,{ex:n,ey:f,ez:o,et:s}=this,{ex:a,ey:l,ez:h,et:c}=t;if(r===BigInt(-1)){let t=d((f-n)*(l+a)),e=d((f+n)*(l-a)),r=d(e-t);if(r===th)return this.double();let i=d(o*tu*c),u=d(s*tu*h),b=u+i,g=e+t,p=u-i,y=d(b*r),B=d(g*p),w=d(b*p);return new A(y,B,d(r*g),w)}let u=d(n*a),b=d(f*l),g=d(s*i*c),p=d(o*h),y=d((n+f)*(a+l)-u-b),B=p-g,w=p+g,x=d(b-r*u),m=d(y*B),E=d(w*x),I=d(y*x);return new A(m,E,d(B*w),I)}subtract(t){return this.add(t.negate())}wNAF(t){return R.wNAFCached(this,S,t,A.normalizeZ)}multiply(t){let{p:e,f:r}=this.wNAF(B(t,i));return A.normalizeZ([e,r])[0]}multiplyUnsafe(t){let e=x(t);return e===th?O:this.equals(O)||e===tc?this:this.equals(L)?this.wNAF(e).p:R.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return R.unsafeLadder(this,i).is0()}toAffine(t){let{ex:e,ey:i,ez:n}=this,f=this.is0();null==t&&(t=f?tb:r.inv(n));let o=d(e*t),s=d(i*t),a=d(n*t);if(f)return{x:th,y:tc};if(a!==tc)throw Error("invZ was invalid");return{x:o,y:s}}clearCofactor(){let{h:t}=e;return t===tc?this:this.multiplyUnsafe(t)}static fromHex(t,i=!1){let{d:n,a:f}=e,o=r.BYTES,s=(t=E("pointHex",t,o)).slice(),a=t[o-1];s[o-1]=-129&a;let c=w(s);c===th||B(c,i?l:r.ORDER);let u=d(c*c),{isValid:b,value:g}=h(d(u-tc),d(n*u-f));if(!b)throw Error("Point.fromHex: invalid y coordinate");let p=(g&tc)===tc,y=!!(128&a);if(!i&&g===th&&y)throw Error("Point.fromHex: x=0 and x_0=1");return y!==p&&(g=d(-g)),A.fromAffine({x:g,y:c})}static fromPrivateKey(t){return U(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),i=m(e,r.BYTES);return i[i.length-1]|=t&tc?128:0,i}toHex(){return c(this.toRawBytes())}}A.BASE=new A(e.Gx,e.Gy,tc,d(e.Gx*e.Gy)),A.ZERO=new A(th,tc,tc,th);let{BASE:L,ZERO:O}=A,R=Y(A,8*s);function U(t){t=E("private key",t,s);let e=E("hashed private key",f(t),2*s),r=u(e.slice(0,s)),n=e.slice(s,2*s),o=P(w(r),i),a=L.multiply(o),l=a.toRawBytes();return{head:r,prefix:n,scalar:o,point:a,pointBytes:l}}function k(t=new Uint8Array,...e){return P(w(f(b(I(...e),E("context",t),!!n))),i)}return L._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return U(t).pointBytes},sign:function(t,e,f={}){t=E("message",t),n&&(t=n(t));let{prefix:o,scalar:a,pointBytes:l}=U(e),d=k(f.context,o,t),h=L.multiply(d).toRawBytes(),c=P(d+k(f.context,h,l,t)*a,i);return x(c),E("result",I(h,m(c,r.BYTES)),2*s)},verify:function(t,e,i,f=tg){let o,s,a;let{context:l,zip215:d}=f,h=r.BYTES;t=E("signature",t,2*h),e=E("message",e),n&&(e=n(e));let c=w(t.slice(h,2*h));try{o=A.fromHex(i,d),s=A.fromHex(t.slice(0,h),d),a=L.multiplyUnsafe(c)}catch(t){return!1}if(!d&&o.isSmallOrder())return!1;let u=k(l,s.toRawBytes(),o.toRawBytes(),e);return s.add(o.multiplyUnsafe(u)).subtract(a).clearCofactor().equals(A.ZERO)},ExtendedPoint:A,utils:{getExtendedPublicKey:U,randomPrivateKey:()=>o(r.BYTES),precompute:(t=8,e=A.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}({a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:tR,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:tB,randomBytes:i.r,adjustScalarBytes:tH,domain:(t,e,r)=>{if(e.length>255)throw Error("Context is too big: "+e.length);return(0,i.c)((0,i.u)("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)},uvRatio:function(t,e){let r=P(t*t*e,tw),i=P(r*t,tw),n=P(i*r*e,tw),f=P(i*tO(n),tw),o=P(f*f,tw);return{isValid:P(o*e,tw)===t,value:f}}}),tk=function(t){let e=(H(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:r}=e,i=t=>P(t,r),n=e.montgomeryBits,f=Math.ceil(n/8),o=e.nByteLength,s=e.adjustScalarBytes||(t=>t),a=e.powPminus2||(t=>G(t,r-BigInt(2),r));function l(t,e,r){let n=i(t*(e-r));return[e=i(e-n),r=i(r+n)]}function d(t){if("bigint"==typeof t&&tp<=t&&t<r)return t;throw Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function c(t,e){let r=function(t,e){let r=d(t),f=d(e),o,s=ty,c=tp,u=r,b=ty,g=tp;for(let t=BigInt(n-1);t>=tp;t--){let e=f>>t&ty;g^=e,s=(o=l(g,s,u))[0],u=o[1],c=(o=l(g,c,b))[0],b=o[1],g=e;let n=s+c,a=i(n*n),d=s-c,p=i(d*d),y=a-p,B=u+b,w=i((u-b)*n),x=i(B*d),m=w+x,E=w-x;u=i(m*m),b=i(r*i(E*E)),s=i(a*p),c=i(y*(a+i(h*y)))}return s=(o=l(g,s,u))[0],u=o[1],c=(o=l(g,c,b))[0],b=o[1],i(s*a(c))}(function(t){let e=E("u coordinate",t,f);return 32===o&&(e[31]&=127),w(e)}(e),function(t){let e=E("scalar",t),r=e.length;if(r!==f&&r!==o)throw Error(`Expected ${f} or ${o} bytes, got ${r}`);return w(s(e))}(t));if(r===tp)throw Error("Invalid private or public key received");return m(i(r),f)}let u=m(i(e.Gu),f);function b(t){return c(t,u)}return{scalarMult:c,scalarMultBase:b,getSharedSecret:(t,e)=>c(t,e),getPublicKey:t=>b(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:u}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:tw,Gu:BigInt(5),powPminus2:t=>P(z(tO(t),BigInt(2),tw)*t,tw),adjustScalarBytes:tH,randomBytes:i.r});tR.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let tF=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),tq=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),t_=BigInt(1),tC=BigInt(2),tN=(t,e)=>(t+e/tC)/e,tP=$(tF,void 0,void 0,{sqrt:function(t){let e=BigInt(3),r=BigInt(6),i=BigInt(11),n=BigInt(22),f=BigInt(23),o=BigInt(44),s=BigInt(88),a=t*t*t%tF,l=a*a*t%tF,d=z(l,e,tF)*l%tF,h=z(d,e,tF)*l%tF,c=z(h,tC,tF)*a%tF,u=z(c,i,tF)*c%tF,b=z(u,n,tF)*u%tF,g=z(b,o,tF)*b%tF,p=z(g,s,tF)*g%tF,y=z(p,o,tF)*b%tF,B=z(y,e,tF)*l%tF,w=z(B,f,tF)*u%tF,x=z(w,r,tF)*a%tF,m=z(x,tC,tF);if(!tP.eql(tP.sqr(m),t))throw Error("Cannot find square root");return m}}),tG=ti({a:BigInt(0),b:BigInt(7),Fp:tP,n:tq,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-t_*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=BigInt("0x100000000000000000000000000000000"),f=tN(e*t,tq),o=tN(-r*t,tq),s=P(t-f*e-o*i,tq),a=P(-f*r-o*e,tq),l=s>n,d=a>n;if(l&&(s=tq-s),d&&(a=tq-a),s>n||a>n)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:s,k2neg:d,k2:a}}}},i.s);BigInt(0),tG.ProjectivePoint;let tz=$(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),tT=ti({a:tz.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:tz,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},i.s),tD=$(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),tZ=ti({a:tD.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:tD,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},i.a),t$=$(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),tj=new Map(Object.entries({nistP256:tf,nistP384:ts,nistP521:td,brainpoolP256r1:tT,brainpoolP384r1:tZ,brainpoolP512r1:ti({a:t$.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:t$,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},i.d),secp256k1:tG,x448:tk,ed448:tU}))},33558:(t,e,r)=>{r.d(e,{C:()=>m,H:()=>B,M:()=>E,a:()=>V,b:()=>f,c:()=>y,d:()=>j,e:()=>s,f:()=>td,g:()=>I,h:()=>o,i:()=>c,j:()=>R,k:()=>ta,l:()=>tl,r:()=>x,s:()=>H,t:()=>p,u:()=>g,w:()=>w});/*! OpenPGP.js v6.0.0-beta.2 - 2024-07-05 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */let i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, not "+t)}function f(t,...e){if(!(t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function a(t,e){f(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let l="object"==typeof i&&"crypto"in i?i.crypto:void 0,d=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),h=(t,e)=>t<<32-e|t>>>e,c=(t,e)=>t<<e|t>>>32-e>>>0,u=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function b(t){var e;for(let r=0;r<t.length;r++)t[r]=(e=t[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function g(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function p(t){return"string"==typeof t&&(t=g(t)),f(t),t}function y(...t){let e=0;for(let r=0;r<t.length;r++){let i=t[r];f(i),e+=i.length}let r=new Uint8Array(e);for(let e=0,i=0;e<t.length;e++){let n=t[e];r.set(n,i),i+=n.length}return r}class B{clone(){return this._cloneInto()}}function w(t){let e=e=>t().update(p(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function x(t=32){if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));throw Error("crypto.getRandomValues must be defined")}let m=(t,e,r)=>t&e^~t&r,E=(t,e,r)=>t&e^t&r^e&r;class I extends B{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=d(this.buffer)}update(t){s(this);let{view:e,buffer:r,blockLen:i}=this,n=(t=p(t)).length;for(let f=0;f<n;){let o=Math.min(i-this.pos,n-f);if(o!==i)r.set(t.subarray(f,f+o),this.pos),this.pos+=o,f+=o,this.pos===i&&(this.process(e,0),this.pos=0);else{let e=d(t);for(;i<=n-f;f+=i)this.process(e,f)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){s(this),a(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:i,isLE:n}=this,{pos:f}=this;e[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>i-f&&(this.process(r,0),f=0);for(let t=f;t<i;t++)e[t]=0;!function(t,e,r,i){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,i);let n=BigInt(32),f=BigInt(4294967295),o=Number(r>>n&f),s=Number(r&f),a=i?4:0,l=i?0:4;t.setUint32(e+a,o,i),t.setUint32(e+l,s,i)}(r,i-8,BigInt(8*this.length),n),this.process(r,0);let o=d(t),l=this.outputLen;if(l%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=l/4,c=this.get();if(h>c.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)o.setUint32(4*t,c[t],n)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:i,finished:n,destroyed:f,pos:o}=this;return t.length=i,t.pos=o,t.finished=n,t.destroyed=f,i%e&&t.buffer.set(r),t}}let S=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),v=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),A=new Uint32Array(64);class L extends I{constructor(){super(64,32,8,!1),this.A=0|v[0],this.B=0|v[1],this.C=0|v[2],this.D=0|v[3],this.E=0|v[4],this.F=0|v[5],this.G=0|v[6],this.H=0|v[7]}get(){let{A:t,B:e,C:r,D:i,E:n,F:f,G:o,H:s}=this;return[t,e,r,i,n,f,o,s]}set(t,e,r,i,n,f,o,s){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|f,this.G=0|o,this.H=0|s}process(t,e){for(let r=0;r<16;r++,e+=4)A[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=A[t-15],r=A[t-2],i=h(e,7)^h(e,18)^e>>>3,n=h(r,17)^h(r,19)^r>>>10;A[t]=n+A[t-7]+i+A[t-16]|0}let{A:r,B:i,C:n,D:f,E:o,F:s,G:a,H:l}=this;for(let t=0;t<64;t++){let e=l+(h(o,6)^h(o,11)^h(o,25))+m(o,s,a)+S[t]+A[t]|0,d=(h(r,2)^h(r,13)^h(r,22))+E(r,i,n)|0;l=a,a=s,s=o,o=f+e|0,f=n,n=i,i=r,r=e+d|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,f=f+this.D|0,o=o+this.E|0,s=s+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,i,n,f,o,s,a,l)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class O extends L{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}let H=w(()=>new L),R=w(()=>new O),U=BigInt(4294967296-1),k=BigInt(32);function F(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){let{h:f,l:o}=function(t,e=!1){return e?{h:Number(t&U),l:Number(t>>k&U)}:{h:0|Number(t>>k&U),l:0|Number(t&U)}}(t[n],e);[r[n],i[n]]=[f,o]}return[r,i]}let q=(t,e,r)=>t<<r|e>>>32-r,_=(t,e,r)=>e<<r|t>>>32-r,C=(t,e,r)=>e<<r-32|t>>>64-r,N=(t,e,r)=>t<<r-32|e>>>64-r,P={split:F,shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,add:function(t,e,r,i){let n=(e>>>0)+(i>>>0);return{h:t+r+(n/4294967296|0)|0,l:0|n}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,i)=>e+r+i+(t/4294967296|0)|0,add4L:(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),add4H:(t,e,r,i,n)=>e+r+i+n+(t/4294967296|0)|0,add5H:(t,e,r,i,n,f)=>e+r+i+n+f+(t/4294967296|0)|0,add5L:(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0)},[G,z]=P.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),T=new Uint32Array(80),D=new Uint32Array(80);class Z extends I{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:r,Bl:i,Ch:n,Cl:f,Dh:o,Dl:s,Eh:a,El:l,Fh:d,Fl:h,Gh:c,Gl:u,Hh:b,Hl:g}=this;return[t,e,r,i,n,f,o,s,a,l,d,h,c,u,b,g]}set(t,e,r,i,n,f,o,s,a,l,d,h,c,u,b,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|f,this.Dh=0|o,this.Dl=0|s,this.Eh=0|a,this.El=0|l,this.Fh=0|d,this.Fl=0|h,this.Gh=0|c,this.Gl=0|u,this.Hh=0|b,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)T[r]=t.getUint32(e),D[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|T[t-15],r=0|D[t-15],i=P.rotrSH(e,r,1)^P.rotrSH(e,r,8)^P.shrSH(e,r,7),n=P.rotrSL(e,r,1)^P.rotrSL(e,r,8)^P.shrSL(e,r,7),f=0|T[t-2],o=0|D[t-2],s=P.rotrSH(f,o,19)^P.rotrBH(f,o,61)^P.shrSH(f,o,6),a=P.rotrSL(f,o,19)^P.rotrBL(f,o,61)^P.shrSL(f,o,6),l=P.add4L(n,a,D[t-7],D[t-16]),d=P.add4H(l,i,s,T[t-7],T[t-16]);T[t]=0|d,D[t]=0|l}let{Ah:r,Al:i,Bh:n,Bl:f,Ch:o,Cl:s,Dh:a,Dl:l,Eh:d,El:h,Fh:c,Fl:u,Gh:b,Gl:g,Hh:p,Hl:y}=this;for(let t=0;t<80;t++){let e=P.rotrSH(d,h,14)^P.rotrSH(d,h,18)^P.rotrBH(d,h,41),B=P.rotrSL(d,h,14)^P.rotrSL(d,h,18)^P.rotrBL(d,h,41),w=d&c^~d&b,x=h&u^~h&g,m=P.add5L(y,B,x,z[t],D[t]),E=P.add5H(m,p,e,w,G[t],T[t]),I=0|m,S=P.rotrSH(r,i,28)^P.rotrBH(r,i,34)^P.rotrBH(r,i,39),v=P.rotrSL(r,i,28)^P.rotrBL(r,i,34)^P.rotrBL(r,i,39),A=r&n^r&o^n&o,L=i&f^i&s^f&s;p=0|b,y=0|g,b=0|c,g=0|u,c=0|d,u=0|h,({h:d,l:h}=P.add(0|a,0|l,0|E,0|I)),a=0|o,l=0|s,o=0|n,s=0|f,n=0|r,f=0|i;let O=P.add3L(I,v,L);r=P.add3H(O,E,S,A),i=0|O}({h:r,l:i}=P.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:f}=P.add(0|this.Bh,0|this.Bl,0|n,0|f)),({h:o,l:s}=P.add(0|this.Ch,0|this.Cl,0|o,0|s)),({h:a,l:l}=P.add(0|this.Dh,0|this.Dl,0|a,0|l)),({h:d,l:h}=P.add(0|this.Eh,0|this.El,0|d,0|h)),({h:c,l:u}=P.add(0|this.Fh,0|this.Fl,0|c,0|u)),({h:b,l:g}=P.add(0|this.Gh,0|this.Gl,0|b,0|g)),({h:p,l:y}=P.add(0|this.Hh,0|this.Hl,0|p,0|y)),this.set(r,i,n,f,o,s,a,l,d,h,c,u,b,g,p,y)}roundClean(){T.fill(0),D.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class $ extends Z{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}let j=w(()=>new Z),V=w(()=>new $),K=[],M=[],Y=[],W=BigInt(0),X=BigInt(1),J=BigInt(2),Q=BigInt(7),tt=BigInt(256),te=BigInt(113);for(let t=0,e=X,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],K.push(2*(5*i+r)),M.push((t+1)*(t+2)/2%64);let n=W;for(let t=0;t<7;t++)(e=(e<<X^(e>>Q)*te)%tt)&J&&(n^=X<<(X<<BigInt(t))-X);Y.push(n)}let[tr,ti]=F(Y,!0),tn=(t,e,r)=>r>32?C(t,e,r):q(t,e,r),tf=(t,e,r)=>r>32?N(t,e,r):_(t,e,r);class to extends B{constructor(t,e,r,i=!1,f=24){var o;if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=i,this.rounds=f,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,n(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=new Uint32Array((o=this.state).buffer,o.byteOffset,Math.floor(o.byteLength/4))}keccak(){u||b(this.state32),function(t,e=24){let r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let i=(e+8)%10,n=(e+2)%10,f=r[n],o=r[n+1],s=tn(f,o,1)^r[i],a=tf(f,o,1)^r[i+1];for(let r=0;r<50;r+=10)t[e+r]^=s,t[e+r+1]^=a}let e=t[2],n=t[3];for(let r=0;r<24;r++){let i=M[r],f=tn(e,n,i),o=tf(e,n,i),s=K[r];e=t[s],n=t[s+1],t[s]=f,t[s+1]=o}for(let e=0;e<50;e+=10){for(let i=0;i<10;i++)r[i]=t[e+i];for(let i=0;i<10;i++)t[e+i]^=~r[(i+2)%10]&r[(i+4)%10]}t[0]^=tr[i],t[1]^=ti[i]}r.fill(0)}(this.state32,this.rounds),u||b(this.state32),this.posOut=0,this.pos=0}update(t){s(this);let{blockLen:e,state:r}=this,i=(t=p(t)).length;for(let n=0;n<i;){let f=Math.min(e-this.pos,i-n);for(let e=0;e<f;e++)r[this.pos++]^=t[n++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:i}=this;t[r]^=e,128&e&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){s(this,!1),f(t),this.finish();let e=this.state,{blockLen:r}=this;for(let i=0,n=t.length;i<n;){this.posOut>=r&&this.keccak();let f=Math.min(r-this.posOut,n-i);t.set(e.subarray(this.posOut,this.posOut+f),i),this.posOut+=f,i+=f}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return n(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(a(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:i,rounds:n,enableXOF:f}=this;return t||(t=new to(e,r,i,f,n)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=n,t.suffix=r,t.outputLen=i,t.enableXOF=f,t.destroyed=this.destroyed,t}}let ts=(t,e,r)=>w(()=>new to(e,t,r)),ta=ts(6,136,32),tl=ts(6,72,64),td=function(t){let e=(e,r)=>t(r).update(p(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}((t={})=>new to(136,31,void 0===t.dkLen?32:t.dkLen,!0))}}]);
